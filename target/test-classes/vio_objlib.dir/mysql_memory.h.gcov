        -:    0:Source:/mnt/hwshare/gcov_mysql/mysql_9_dfb4f427442f5fc4112a4847c09e1c51e420077c_pre/include/mysql/psi/mysql_memory.h
        -:    0:Graph:vio.cc.gcno
        -:    0:Data:vio.cc.gcda
        -:    0:Runs:4
        -:    0:Programs:2
        -:    1:/* Copyright (c) 2012, 2021, Oracle and/or its affiliates.
        -:    2:
        -:    3:  This program is free software; you can redistribute it and/or modify
        -:    4:  it under the terms of the GNU General Public License, version 2.0,
        -:    5:  as published by the Free Software Foundation.
        -:    6:
        -:    7:  This program is also distributed with certain software (including
        -:    8:  but not limited to OpenSSL) that is licensed under separate terms,
        -:    9:  as designated in a particular file or component or in included license
        -:   10:  documentation.  The authors of MySQL hereby grant you an additional
        -:   11:  permission to link the program and your derivative works with the
        -:   12:  separately licensed software that they have included with MySQL.
        -:   13:
        -:   14:  This program is distributed in the hope that it will be useful,
        -:   15:  but WITHOUT ANY WARRANTY; without even the implied warranty of
        -:   16:  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
        -:   17:  GNU General Public License, version 2.0, for more details.
        -:   18:
        -:   19:  You should have received a copy of the GNU General Public License
        -:   20:  along with this program; if not, write to the Free Software
        -:   21:  Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301  USA */
        -:   22:
        -:   23:#ifndef MYSQL_MEMORY_H
        -:   24:#define MYSQL_MEMORY_H
        -:   25:
        -:   26:/**
        -:   27:  @file include/mysql/psi/mysql_memory.h
        -:   28:  Instrumentation helpers for memory allocation.
        -:   29:*/
        -:   30:
        -:   31:#include "my_compiler.h"
        -:   32:
        -:   33:/* HAVE_PSI_*_INTERFACE */
        -:   34:#include "my_psi_config.h"  // IWYU pragma: keep
        -:   35:
        -:   36:#include "mysql/psi/psi_memory.h"
        -:   37:
        -:   38:#if defined(MYSQL_SERVER) || defined(PFS_DIRECT_CALL)
        -:   39:/* PSI_MEMORY_CALL() as direct call. */
        -:   40:#include "pfs_memory_provider.h"  // IWYU pragma: keep
        -:   41:#endif
        -:   42:
        -:   43:#ifndef PSI_MEMORY_CALL
        -:   44:#define PSI_MEMORY_CALL(M) psi_memory_service->M
        -:   45:#endif
        -:   46:
        -:   47:/**
        -:   48:  @defgroup psi_api_memory Memory Instrumentation (API)
        -:   49:  @ingroup psi_api
        -:   50:  @{
        -:   51:*/
        -:   52:
        -:   53:/**
        -:   54:  @def mysql_memory_register(P1, P2, P3)
        -:   55:  Memory registration.
        -:   56:*/
        -:   57:#define mysql_memory_register(P1, P2, P3) \
        -:   58:  inline_mysql_memory_register(P1, P2, P3)
        -:   59:
        1:   60:static inline void inline_mysql_memory_register(
        -:   61:#ifdef HAVE_PSI_MEMORY_INTERFACE
        -:   62:    const char *category, PSI_memory_info *info, int count)
        -:   63:#else
        -:   64:    const char *category [[maybe_unused]], void *info [[maybe_unused]],
        -:   65:    int count [[maybe_unused]])
        -:   66:#endif
        -:   67:{
        -:   68:#ifdef HAVE_PSI_MEMORY_INTERFACE
        1:   69:  PSI_MEMORY_CALL(register_memory)(category, info, count);
        -:   70:#endif
        1:   71:}
        -:   72:
        -:   73:/** @} (end of group psi_api_memory) */
        -:   74:
        -:   75:#endif
